<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <!-- Pengaturan Penting agar responsif di HP (Mencegah zoom otomatis) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Belajar Matematika - Aurel (Responsive)</title>
    
    <!-- Import Font Lucu -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <!-- Import Icon Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* Palet Warna Ceria */
            --primary: #FF6B8B;   /* Pink */
            --secondary: #4ECDC4; /* Biru Tosca */
            --accent: #FFE66D;    /* Kuning */
            --dark: #2F2F2F;
            --light: #FFFFFF;
            
            --bg-gradient: linear-gradient(135deg, #A18CD1 0%, #FBC2EB 100%);
            --shadow: 0 8px 0 rgba(0,0,0,0.15);
            --radius: 25px; /* Sudut membulat */
        }

        * {
            box-sizing: border-box;
            /* Mencegah seleksi teks saat menekan tombol berulang kali di HP */
            -webkit-tap-highlight-color: transparent; 
            user-select: none;
        }

        /* Input tetap bisa diseleksi teksnya */
        input, select {
            user-select: auto;
            -webkit-tap-highlight-color: auto;
        }

        body {
            margin: 0;
            font-family: 'Comic Neue', cursive, sans-serif;
            background: var(--bg-gradient);
            background-size: 200% 200%;
            animation: gradientMove 10s ease infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden; 
            padding: 15px; /* Jarak aman dari tepi layar HP */
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Container Utama - Menyesuaikan Lebar Layar */
        .container {
            background: var(--light);
            width: 100%;
            max-width: 500px; /* Maksimal lebar di Laptop/PC */
            padding: 30px 20px;
            border-radius: var(--radius);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            text-align: center;
            position: relative;
            border: 4px solid white;
            outline: 4px solid var(--primary);
            outline-offset: -4px;
            transition: transform 0.3s;
        }

        /* Desktop Style: Lebih lega */
        @media (min-width: 600px) {
            .container {
                padding: 50px 40px;
                border-width: 6px;
                outline-width: 6px;
            }
        }

        /* HP Kecil Style: Lebih kompak */
        @media (max-width: 380px) {
            .container {
                padding: 20px 15px;
            }
            h1 { font-size: 26px; }
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            color: var(--primary);
            font-size: 32px; /* Ukuran base HP */
            margin: 0;
            text-shadow: 2px 2px 0px #FFD166;
            line-height: 1.2;
        }

        @media (min-width: 600px) {
            h1 { font-size: 42px; } /* Lebih besar di PC */
        }

        .sound-btn {
            background: var(--accent);
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            color: var(--dark);
            box-shadow: 0 4px 0 #E5C331;
            transition: all 0.2s;
            flex-shrink: 0; /* Agar tidak mengecil */
        }

        .sound-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #E5C331;
        }

        .sound-btn.active {
            color: var(--primary);
            border: 2px solid white;
        }

        .select-wrapper {
            position: relative;
            margin-bottom: 20px;
        }

        select {
            width: 100%;
            padding: 15px;
            border-radius: var(--radius);
            border: 3px dashed #BDC3C7;
            font-family: 'Fredoka One', cursive;
            font-size: 16px;
            color: var(--dark);
            background: #F7F9FC;
            cursor: pointer;
            appearance: none;
        }

        .select-wrapper::after {
            content: '\f107';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary);
            font-size: 20px;
            pointer-events: none;
        }

        .soal-container {
            background: #E0F7FA;
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 3px solid #B2EBF2;
        }

        .soal {
            font-family: 'Fredoka One', cursive;
            font-size: 48px; /* Base size */
            color: var(--dark);
            margin: 0;
            text-shadow: 3px 3px 0px rgba(0,0,0,0.1);
            word-wrap: break-word;
        }

        /* Responsive Font Size untuk Soal */
        @media (max-width: 380px) { .soal { font-size: 38px; } }
        @media (min-width: 600px) { .soal { font-size: 64px; } }

        .label-soal {
            font-size: 14px;
            color: #0097A7;
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
            text-transform: uppercase;
        }

        .controls-wrapper {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            width: 100%;
        }

        input {
            flex: 1;
            padding: 12px;
            border-radius: var(--radius);
            border: 3px solid #E0E0E0;
            font-family: 'Fredoka One', cursive;
            font-size: 28px;
            text-align: center;
            color: var(--primary);
            background: #FFF8E1;
            transition: all 0.3s;
            /* Hapus spinner number input default browser */
            -moz-appearance: textfield;
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input:focus {
            outline: none;
            border-color: var(--secondary);
            transform: scale(1.01);
            box-shadow: 0 0 0 4px rgba(78, 205, 196, 0.2);
        }

        .btn-row {
            display: flex;
            gap: 10px;
            width: 100%;
        }

        .btn {
            padding: 15px 10px;
            border: none;
            border-radius: var(--radius);
            font-family: 'Fredoka One', cursive;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.1s; /* Lebih cepat di HP */
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            top: 0;
            flex: 1; /* Tombol mengisi ruang sama rata */
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        /* Efek 3D Tombol */
        .btn-check {
            background: var(--secondary);
            box-shadow: 0 6px 0 #3DBBB3;
        }
        .btn-check:active {
            top: 6px;
            box-shadow: 0 0 0 #3DBBB3;
        }

        .btn-skip {
            background: #BDC3C7;
            box-shadow: 0 6px 0 #95A5A6;
            font-size: 14px;
        }
        .btn-skip:active {
            top: 6px;
            box-shadow: 0 0 0 #95A5A6;
        }

        .btn-start {
            background: var(--primary);
            box-shadow: 0 8px 0 #D64561;
            width: 100%;
            font-size: 20px;
            padding: 18px;
        }
        .btn-start:active {
            top: 8px;
            box-shadow: 0 0 0 #D64561;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 4px dashed #E0E0E0;
        }

        .score {
            font-family: 'Fredoka One', cursive;
            font-size: 18px;
            color: var(--dark);
            background: #FFF3E0;
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid #FFE0B2;
            flex-shrink: 0;
        }

        .score span {
            color: #FF9F43;
            font-size: 22px;
        }

        .pesan {
            min-height: 35px;
            font-family: 'Fredoka One', cursive;
            font-size: 18px;
            margin-bottom: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .pesan.show {
            opacity: 1;
        }

        .pesan.benar { color: var(--secondary); }
        .pesan.salah { color: var(--primary); }

        @keyframes cuteShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-6px) rotate(-3deg); }
            50% { transform: translateX(6px) rotate(3deg); }
            75% { transform: translateX(-6px) rotate(-3deg); }
            100% { transform: translateX(0); }
        }

        .shake {
            animation: cuteShake 0.4s ease-in-out;
            border-color: var(--primary) !important;
            background-color: #FFEBEE !important;
        }

        #confetti-canvas {
            position: fixed; /* Fixed agar menutupi seluruh layar */
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 999;
        }
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <div class="header">
        <div style="text-align: left;">
            <h1>Matematika</h1>
            <small style="font-weight: bold; color: #888; display:block; font-size: 14px;">Halo, Aurel! üëã</small>
        </div>
        <button class="sound-btn active" id="soundToggle" onclick="toggleSound()" aria-label="Toggle Suara">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>

    <div class="select-wrapper">
        <select id="mode">
            <option value="tambah">‚ûï Penjumlahan</option>
            <option value="kurang">‚ûñ Pengurangan</option>
            <option value="kali">‚úñÔ∏è Perkalian</option>
            <option value="bagi">‚ûó Pembagian</option>
        </select>
    </div>

    <div id="startArea">
        <button class="btn btn-start" onclick="mulaiGame()">Mulai Belajar üöÄ</button>
    </div>

    <div id="gameArea" style="display:none; margin-top: 20px;">
        <div class="soal-container">
            <span class="label-soal">Berapakah hasilnya?</span>
            <div class="soal" id="soal">...</div>
        </div>

        <div class="pesan" id="pesan"></div>

        <div class="controls-wrapper">
            <div class="input-group">
                <input type="number" id="jawaban" placeholder="?" inputmode="numeric" onkeydown="if(event.key==='Enter') cekJawaban()">
            </div>
            <div class="btn-row">
                <button class="btn btn-check" onclick="cekJawaban()">
                    <i class="fas fa-check"></i> Cek
                </button>
                <button class="btn btn-skip" onclick="forceNextQuestion()">
                    Lewati ‚û°Ô∏è
                </button>
            </div>
        </div>
    </div>

    <div class="score-board">
        <div class="score">Skor: <span id="scoreVal">0</span> ‚≠ê</div>
        <button class="btn btn-skip" onclick="resetGame()" style="display:none; width: auto; padding: 8px 15px; font-size: 12px;" id="resetBtn">Ulangi</button>
    </div>
</div>

<script>
// --- Variabel Game ---
let angka1, angka2, jawabanBenar;
let skor = 0;
let soundEnabled = true;
let gameActive = false;

// --- Elemen DOM ---
const soalEl = document.getElementById("soal");
const inputEl = document.getElementById("jawaban");
const scoreEl = document.getElementById("scoreVal");
const pesanEl = document.getElementById("pesan");
const gameArea = document.getElementById("gameArea");
const startArea = document.getElementById("startArea");
const soundBtn = document.getElementById("soundToggle");
const resetBtn = document.getElementById("resetBtn");

// --- Fungsi Suara Utama ---
function suara(teks, callback) {
    if (!soundEnabled) {
        if(callback) callback();
        return;
    }
    
    window.speechSynthesis.cancel(); 

    const ucapan = new SpeechSynthesisUtterance(teks);
    ucapan.lang = 'id-ID'; 
    ucapan.rate = 0.9;     
    ucapan.pitch = 1.2;    
    
    if (callback) {
        ucapan.onend = function() {
            callback();
        };
        ucapan.onerror = function() {
            callback();
        };
    }
    
    window.speechSynthesis.speak(ucapan);
}

function toggleSound() {
    soundEnabled = !soundEnabled;
    if(soundEnabled) {
        soundBtn.classList.add('active');
        soundBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
    } else {
        soundBtn.classList.remove('active');
        soundBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
        window.speechSynthesis.cancel();
    }
}

// --- Logika Game ---

function mulaiGame() {
    skor = 0;
    gameActive = true;
    updateScore();
    pesanEl.className = "pesan";
    
    startArea.style.display = "none";
    gameArea.style.display = "block";
    resetBtn.style.display = "block";
    
    resetUIState();
    
    soalEl.innerText = "üëÇ...";
    
    setTimeout(() => inputEl.focus(), 100);

    sapaanPertama();
}

function sapaanPertama() {
    const teksSapaan = "Aurel, mari kita belajar. Perhatikan dengan teliti.";
    suara(teksSapaan, function() {
        soalBaru();
    });
}

function resetGame() {
    window.speechSynthesis.cancel();
    gameArea.style.display = "none";
    startArea.style.display = "block";
    resetBtn.style.display = "none";
    pesanEl.innerText = "";
    skor = 0;
    updateScore();
}

function resetUIState() {
    inputEl.value = "";
    pesanEl.classList.remove("show");
    inputEl.classList.remove("shake");
    inputEl.disabled = false;
}

function forceNextQuestion() {
    window.speechSynthesis.cancel();
    soalBaru();
}

function soalBaru() {
    resetUIState();

    let mode = document.getElementById("mode").value;
    let teksSoal = ""; 

    angka1 = Math.floor(Math.random() * 20) + 1;
    angka2 = Math.floor(Math.random() * 20) + 1;

    if (mode === "tambah") {
        jawabanBenar = angka1 + angka2;
        soalEl.innerText = `${angka1} + ${angka2}`;
        teksSoal = `${angka1} ditambah ${angka2} sama dengan berapa?`;
    } 
    else if (mode === "kurang") {
        if (angka1 < angka2) {
            [angka1, angka2] = [angka2, angka1];
        }
        jawabanBenar = angka1 - angka2;
        soalEl.innerText = `${angka1} - ${angka2}`;
        teksSoal = `${angka1} dikurangi ${angka2} sama dengan berapa?`;
    } 
    else if (mode === "kali") {
        angka1 = Math.floor(Math.random() * 10) + 1;
        angka2 = Math.floor(Math.random() * 10) + 1;
        jawabanBenar = angka1 * angka2;
        soalEl.innerText = `${angka1} √ó ${angka2}`;
        teksSoal = `${angka1} dikali ${angka2} sama dengan berapa?`;
    } 
    else if (mode === "bagi") {
        jawabanBenar = Math.floor(Math.random() * 10) + 1; 
        angka2 = Math.floor(Math.random() * 9) + 2;       
        angka1 = jawabanBenar * angka2;                   
        soalEl.innerText = `${angka1} √∑ ${angka2}`;
        teksSoal = `${angka1} dibagi ${angka2} sama dengan berapa?`;
    }

    suara(teksSoal);
}

function cekJawaban() {
    if (!gameActive) return;

    let jawabanUser = inputEl.value;
    
    if (jawabanUser === "") return; 

    jawabanUser = parseInt(jawabanUser);

    if (jawabanUser === jawabanBenar) {
        // JAWABAN BENAR
        skor += 10;
        updateScore();
        
        pesanEl.innerHTML = "üéâ Hebat Aurel!"; 
        pesanEl.className = "pesan show benar";
        
        inputEl.disabled = true; 
        
        triggerConfetti();
        
        // Tunggu suara selesai, baru lanjut
        suara("Hebat Aurel, jawaban benar. Kamu hebat.", function() {
            soalBaru();
        });
        
    } else {
        // JAWABAN SALAH
        pesanEl.innerHTML = "ü§î Ups, coba lagi ya!";
        pesanEl.className = "pesan show salah";
        
        suara("Ups, salah, coba lagi.");
        
        inputEl.classList.add("shake");
        inputEl.value = "";
        inputEl.focus();
        
        setTimeout(() => inputEl.classList.remove("shake"), 400);
    }
}

function updateScore() {
    scoreEl.innerText = skor;
}

// --- Efek Confetti ---
const canvas = document.getElementById("confetti-canvas");
const ctx = canvas.getContext("2d");
let particles = [];

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function triggerConfetti() {
    for (let i = 0; i < 80; i++) {
        particles.push({
            x: window.innerWidth / 2,
            y: window.innerHeight / 2,
            vx: (Math.random() - 0.5) * 20,
            vy: (Math.random() - 0.5) * 20 - 5,
            life: 120,
            color: `hsl(${Math.random() * 360}, 100%, 60%)`,
            size: Math.random() * 10 + 5,
            rotation: Math.random() * 360,
            rotationSpeed: (Math.random() - 0.5) * 10
        });
    }
    if (particles.length > 0 && !isAnimating) {
        animateConfetti();
    }
}

let isAnimating = false;

function animateConfetti() {
    isAnimating = true;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    for (let i = 0; i < particles.length; i++) {
        let p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.5; 
        p.life--;
        p.rotation += p.rotationSpeed;
        
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rotation * Math.PI / 180);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
        ctx.restore();
    }
    
    particles = particles.filter(p => p.life > 0);
    
    if (particles.length > 0) {
        requestAnimationFrame(animateConfetti);
    } else {
        isAnimating = false;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
}
</script>

</body>
</html>
